// Code generated by the Pulumi Terraform Bridge (tfgen) Tool DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package okta

import (
	"context"
	"reflect"

	"github.com/pkg/errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// This resource allows you to configure Threat Insight Settings.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-okta/sdk/v3/go/okta"
//	"github.com/pulumi/pulumi-okta/sdk/v3/go/okta/network"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			ipNetworkZoneExample, err := network.NewZone(ctx, "ipNetworkZoneExample", &network.ZoneArgs{
//				Type: pulumi.String("IP"),
//				Gateways: pulumi.StringArray{
//					pulumi.String("1.2.3.4/24"),
//					pulumi.String("2.3.4.5-2.3.4.15"),
//				},
//				Proxies: pulumi.StringArray{
//					pulumi.String("2.2.3.4/24"),
//					pulumi.String("3.3.4.5-3.3.4.15"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			_, err = okta.NewThreatInsightSettings(ctx, "example", &okta.ThreatInsightSettingsArgs{
//				Action: pulumi.String("block"),
//				NetworkExcludes: pulumi.StringArray{
//					ipNetworkZoneExample.ID(),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// Threat Insight Settings can be imported without any parameters.
//
// ```sh
//
//	$ pulumi import okta:index/threatInsightSettings:ThreatInsightSettings example _
//
// ```
type ThreatInsightSettings struct {
	pulumi.CustomResourceState

	// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
	// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
	// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
	// requests in the System Log and blocks the requests.
	Action pulumi.StringOutput `pulumi:"action"`
	// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
	// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
	// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
	// is not guarantee from the API sides
	NetworkExcludes pulumi.StringArrayOutput `pulumi:"networkExcludes"`
}

// NewThreatInsightSettings registers a new resource with the given unique name, arguments, and options.
func NewThreatInsightSettings(ctx *pulumi.Context,
	name string, args *ThreatInsightSettingsArgs, opts ...pulumi.ResourceOption) (*ThreatInsightSettings, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Action == nil {
		return nil, errors.New("invalid value for required argument 'Action'")
	}
	var resource ThreatInsightSettings
	err := ctx.RegisterResource("okta:index/threatInsightSettings:ThreatInsightSettings", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetThreatInsightSettings gets an existing ThreatInsightSettings resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetThreatInsightSettings(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *ThreatInsightSettingsState, opts ...pulumi.ResourceOption) (*ThreatInsightSettings, error) {
	var resource ThreatInsightSettings
	err := ctx.ReadResource("okta:index/threatInsightSettings:ThreatInsightSettings", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering ThreatInsightSettings resources.
type threatInsightSettingsState struct {
	// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
	// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
	// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
	// requests in the System Log and blocks the requests.
	Action *string `pulumi:"action"`
	// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
	// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
	// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
	// is not guarantee from the API sides
	NetworkExcludes []string `pulumi:"networkExcludes"`
}

type ThreatInsightSettingsState struct {
	// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
	// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
	// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
	// requests in the System Log and blocks the requests.
	Action pulumi.StringPtrInput
	// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
	// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
	// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
	// is not guarantee from the API sides
	NetworkExcludes pulumi.StringArrayInput
}

func (ThreatInsightSettingsState) ElementType() reflect.Type {
	return reflect.TypeOf((*threatInsightSettingsState)(nil)).Elem()
}

type threatInsightSettingsArgs struct {
	// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
	// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
	// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
	// requests in the System Log and blocks the requests.
	Action string `pulumi:"action"`
	// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
	// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
	// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
	// is not guarantee from the API sides
	NetworkExcludes []string `pulumi:"networkExcludes"`
}

// The set of arguments for constructing a ThreatInsightSettings resource.
type ThreatInsightSettingsArgs struct {
	// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
	// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
	// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
	// requests in the System Log and blocks the requests.
	Action pulumi.StringInput
	// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
	// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
	// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
	// is not guarantee from the API sides
	NetworkExcludes pulumi.StringArrayInput
}

func (ThreatInsightSettingsArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*threatInsightSettingsArgs)(nil)).Elem()
}

type ThreatInsightSettingsInput interface {
	pulumi.Input

	ToThreatInsightSettingsOutput() ThreatInsightSettingsOutput
	ToThreatInsightSettingsOutputWithContext(ctx context.Context) ThreatInsightSettingsOutput
}

func (*ThreatInsightSettings) ElementType() reflect.Type {
	return reflect.TypeOf((**ThreatInsightSettings)(nil)).Elem()
}

func (i *ThreatInsightSettings) ToThreatInsightSettingsOutput() ThreatInsightSettingsOutput {
	return i.ToThreatInsightSettingsOutputWithContext(context.Background())
}

func (i *ThreatInsightSettings) ToThreatInsightSettingsOutputWithContext(ctx context.Context) ThreatInsightSettingsOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ThreatInsightSettingsOutput)
}

// ThreatInsightSettingsArrayInput is an input type that accepts ThreatInsightSettingsArray and ThreatInsightSettingsArrayOutput values.
// You can construct a concrete instance of `ThreatInsightSettingsArrayInput` via:
//
//	ThreatInsightSettingsArray{ ThreatInsightSettingsArgs{...} }
type ThreatInsightSettingsArrayInput interface {
	pulumi.Input

	ToThreatInsightSettingsArrayOutput() ThreatInsightSettingsArrayOutput
	ToThreatInsightSettingsArrayOutputWithContext(context.Context) ThreatInsightSettingsArrayOutput
}

type ThreatInsightSettingsArray []ThreatInsightSettingsInput

func (ThreatInsightSettingsArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*ThreatInsightSettings)(nil)).Elem()
}

func (i ThreatInsightSettingsArray) ToThreatInsightSettingsArrayOutput() ThreatInsightSettingsArrayOutput {
	return i.ToThreatInsightSettingsArrayOutputWithContext(context.Background())
}

func (i ThreatInsightSettingsArray) ToThreatInsightSettingsArrayOutputWithContext(ctx context.Context) ThreatInsightSettingsArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ThreatInsightSettingsArrayOutput)
}

// ThreatInsightSettingsMapInput is an input type that accepts ThreatInsightSettingsMap and ThreatInsightSettingsMapOutput values.
// You can construct a concrete instance of `ThreatInsightSettingsMapInput` via:
//
//	ThreatInsightSettingsMap{ "key": ThreatInsightSettingsArgs{...} }
type ThreatInsightSettingsMapInput interface {
	pulumi.Input

	ToThreatInsightSettingsMapOutput() ThreatInsightSettingsMapOutput
	ToThreatInsightSettingsMapOutputWithContext(context.Context) ThreatInsightSettingsMapOutput
}

type ThreatInsightSettingsMap map[string]ThreatInsightSettingsInput

func (ThreatInsightSettingsMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*ThreatInsightSettings)(nil)).Elem()
}

func (i ThreatInsightSettingsMap) ToThreatInsightSettingsMapOutput() ThreatInsightSettingsMapOutput {
	return i.ToThreatInsightSettingsMapOutputWithContext(context.Background())
}

func (i ThreatInsightSettingsMap) ToThreatInsightSettingsMapOutputWithContext(ctx context.Context) ThreatInsightSettingsMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ThreatInsightSettingsMapOutput)
}

type ThreatInsightSettingsOutput struct{ *pulumi.OutputState }

func (ThreatInsightSettingsOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**ThreatInsightSettings)(nil)).Elem()
}

func (o ThreatInsightSettingsOutput) ToThreatInsightSettingsOutput() ThreatInsightSettingsOutput {
	return o
}

func (o ThreatInsightSettingsOutput) ToThreatInsightSettingsOutputWithContext(ctx context.Context) ThreatInsightSettingsOutput {
	return o
}

// Specifies how Okta responds to authentication requests from suspicious IPs. Valid values
// are `"none"`, `"audit"`, or `"block"`. A value of `"none"` indicates that ThreatInsight is disabled. A value of `"audit"`
// indicates that Okta logs suspicious requests in the System Log. A value of `"block"` indicates that Okta logs suspicious
// requests in the System Log and blocks the requests.
func (o ThreatInsightSettingsOutput) Action() pulumi.StringOutput {
	return o.ApplyT(func(v *ThreatInsightSettings) pulumi.StringOutput { return v.Action }).(pulumi.StringOutput)
}

// Accepts a list of Network Zone IDs. Can only accept zones of `"IP"` type.
// IPs in the excluded Network Zones aren't logged or blocked by Okta ThreatInsight and proceed to Sign On rules evaluation.
// This ensures that traffic from known, trusted IPs isn't accidentally logged or blocked. The ordering of the network zone
// is not guarantee from the API sides
func (o ThreatInsightSettingsOutput) NetworkExcludes() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *ThreatInsightSettings) pulumi.StringArrayOutput { return v.NetworkExcludes }).(pulumi.StringArrayOutput)
}

type ThreatInsightSettingsArrayOutput struct{ *pulumi.OutputState }

func (ThreatInsightSettingsArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*ThreatInsightSettings)(nil)).Elem()
}

func (o ThreatInsightSettingsArrayOutput) ToThreatInsightSettingsArrayOutput() ThreatInsightSettingsArrayOutput {
	return o
}

func (o ThreatInsightSettingsArrayOutput) ToThreatInsightSettingsArrayOutputWithContext(ctx context.Context) ThreatInsightSettingsArrayOutput {
	return o
}

func (o ThreatInsightSettingsArrayOutput) Index(i pulumi.IntInput) ThreatInsightSettingsOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *ThreatInsightSettings {
		return vs[0].([]*ThreatInsightSettings)[vs[1].(int)]
	}).(ThreatInsightSettingsOutput)
}

type ThreatInsightSettingsMapOutput struct{ *pulumi.OutputState }

func (ThreatInsightSettingsMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*ThreatInsightSettings)(nil)).Elem()
}

func (o ThreatInsightSettingsMapOutput) ToThreatInsightSettingsMapOutput() ThreatInsightSettingsMapOutput {
	return o
}

func (o ThreatInsightSettingsMapOutput) ToThreatInsightSettingsMapOutputWithContext(ctx context.Context) ThreatInsightSettingsMapOutput {
	return o
}

func (o ThreatInsightSettingsMapOutput) MapIndex(k pulumi.StringInput) ThreatInsightSettingsOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *ThreatInsightSettings {
		return vs[0].(map[string]*ThreatInsightSettings)[vs[1].(string)]
	}).(ThreatInsightSettingsOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*ThreatInsightSettingsInput)(nil)).Elem(), &ThreatInsightSettings{})
	pulumi.RegisterInputType(reflect.TypeOf((*ThreatInsightSettingsArrayInput)(nil)).Elem(), ThreatInsightSettingsArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*ThreatInsightSettingsMapInput)(nil)).Elem(), ThreatInsightSettingsMap{})
	pulumi.RegisterOutputType(ThreatInsightSettingsOutput{})
	pulumi.RegisterOutputType(ThreatInsightSettingsArrayOutput{})
	pulumi.RegisterOutputType(ThreatInsightSettingsMapOutput{})
}
